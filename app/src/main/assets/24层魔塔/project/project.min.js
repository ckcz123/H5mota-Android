var data_a1e2fb4a_e986_4524_b0da_9b7ba7c0874d={main:{floorIds:["MT0","MT1","MT2","MT3","MT4","MT5","MT6","MT7","MT8","MT9","MT10","MT11","MT12","MT13","MT14","MT15","MT16","MT17","MT18","MT19","MT20","MT21","MT22","MT23w","MT23e","MT23s","MT_1"],images:["winskin.png"],tilesets:[],animates:[],bgms:["title.wav","startText.mp3","prologue.mp3","area1.mp3","area2.mp3","area3.mp3"],sounds:["attack.mp3","floor.mp3","door.mp3","item.mp3","dialogue.mp3","unlockCtrl.mp3","step.mp3","constants.mp3","keySold.mp3","keyUnsold.mp3","redWizard.mp3","brownWizard.mp3","whiteKing.mp3","blackMagician.mp3","load.mp3"],nameMap:{},startBackground:"title.png",startLogoStyle:"display:none",levelChoose:[["",""]],equipName:[],startBgm:"title.wav",statusLeftBackground:"url(project/images/ground.png) repeat",statusTopBackground:"url(project/images/ground.png) repeat",toolsBackground:"url(project/images/ground.png) repeat",borderColor:"white",statusBarColor:"white",hardLabelColor:"white",floorChangingBackground:"black",floorChangingTextColor:"white",font:"Verdana",startButtonsStyle:"background-color: #000000; opacity: 1; color: #FFFFFF; border: #000000 1px solid; caret-color: #FFFFFF;"},firstData:{title:"24层魔塔",name:"24",version:"Ver 1.12",floorId:"MT0",hero:{name:"勇士：",lv:1,hpmax:9999,hp:1000,manamax:-1,mana:0,atk:10,def:10,mdef:0,money:0,experience:0,equipment:[],items:{keys:{yellowKey:0,blueKey:0,redKey:0},constants:{book:1},tools:{},equips:{}},loc:{direction:"down",x:6,y:10},flags:{},steps:0},startCanvas:[],startText:[{type:"pauseBgm"},{type:"hideStatusBar"},{type:"confirm","default":true,text:"是否观看片头？（四十秒）",yes:[{type:"setVolume",value:0,time:0},{type:"playBgm",name:"startText.mp3"},{type:"setVolume",value:100,time:40000,async:true},{type:"scrollText",text:"这是一个很古老的故事\n在很久很久以前，在遥远的西方大地上，\n有着这样一个王国，\n王国虽小但全国的人们都生活得非常幸福和快乐。\n突然有一天，从天空飞来一群可怕的怪物，\n它们来到皇宫，抢走了国王唯一的女儿。\n第二天，国王便向全国下达了紧急令，\n只要谁能将公主给找回来，他便将王位让给他。\n于是，全国的勇士们都出发了。\n他们的足迹走遍了全国的各个角落，\n可一点儿线索都没有找到，时间很快就过去了一个月。\n终于，在国王命令下达的第三十一天，\n一个从远方归来的人告诉国王，\n说在海边的一座小岛上，曾看到一群怪物出现过。\n勇士们又出发了，可是，却没有一个人可以回来，\n有幸回来的，都再也不敢去了。\n而我们的故事，便是从这里开始……",time:40000,lineHeight:2}],no:[{type:"function","function":"function(){\ncore.addItem('yellowKey');\ncore.addItem('blueKey');\ncore.addItem('redKey');\ncore.hideBlock(6, 9, 'MT0');\ncore.setBlock('fairy', 5, 9, 'MT0')\n}"}]},{type:"setText",title:[255,255,255,1],background:[0,0,0,1]}],shops:[{id:"moneyShop1",name:" ",icon:"blueShop",textInList:"三楼商店",commonTimes:true,mustEnable:false,use:"money",need:"25",text:"想要增加你的能力吗？\\n如果你有25个金币，你可以任意选择一项：",choices:[{text:"增加800点生命",effect:"status:hp+=800"},{text:"增加4点攻击",effect:"status:atk+=4"},{text:"增加4点防御",effect:"status:def+=4"}]},{id:"moneyShop2",name:" ",icon:"blueShop",textInList:"11楼商店",commonTimes:true,mustEnable:false,use:"money",need:"100",text:"想要增加你的能力吗？\\n如果你有100个金币，\\n你可以任意选择一项：",choices:[{text:"增加4000点生命",effect:"status:hp+=4000"},{text:"增加20点攻击",effect:"status:atk+=20"},{text:"增加20点防御",effect:"status:def+=20"}]},{id:"expShop1",name:" ",icon:"man",textInList:"五楼老人",commonTimes:true,mustEnable:false,use:"experience",need:"-1",text:"你好，英雄的人类，只要你有足够的经验，我就可以让你变得更强大：",choices:[{text:"提升一级",need:"100",effect:"status:lv+=1;status:hp+=1000;status:atk+=7;status:def+=7"},{text:"增加攻击5",need:"30",effect:"status:atk+=5"},{text:"增加防御5",need:"30",effect:"status:def+=5"}]},{id:"expShop2",name:" ",icon:"man",textInList:"13楼老人",commonTimes:true,mustEnable:false,use:"experience",need:"-1",text:"你好，英雄的人类，只要你有足够的经验，我就可以让你变得更强大：",choices:[{text:"提升三级",need:"270",effect:"status:lv+=3;status:hp+=3000;status:atk+=20;status:def+=20"},{text:"增加攻击17",need:"95",effect:"status:atk+=17"},{text:"增加防御17",need:"95",effect:"status:def+=17"}]},{id:"keyShop1",name:" ",icon:"woman",textInList:"购入钥匙",commonTimes:true,mustEnable:false,use:"money",need:"-1",text:"相信你一定有特殊的需要，只要你有金币，我就可以帮你：",choices:[{text:"购买1把黄钥匙",need:"10",effect:"item:yellowKey+=1"},{text:"购买1把蓝钥匙",need:"50",effect:"item:blueKey+=1"},{text:"购买1把红钥匙",need:"100",effect:"item:redKey+=1"}]},{id:"keyShop2",textInList:"卖出钥匙",mustEnable:false,commonEvent:"回收钥匙商店"}],levelUp:[{need:"0",title:"",action:[]}]},values:{lavaDamage:100,poisonDamage:10,weakValue:20,redJewel:3,blueJewel:3,greenJewel:5,redPotion:200,bluePotion:500,yellowPotion:500,greenPotion:800,breakArmor:0.9,counterAttack:0.1,purify:3,hatred:2,moveSpeed:125,animateSpeed:300,floorChangeTime:100},flags:{enableFloor:true,enableName:false,enableLv:true,enableHPMax:false,enableMana:false,enableMDef:false,enableMoney:true,enableExperience:true,enableLevelUp:false,levelUpLeftMode:false,enableKeys:true,enablePZF:false,enableDebuff:false,enableSkill:false,flyNearStair:false,flyRecordPosition:false,pickaxeFourDirections:false,bombFourDirections:false,snowFourDirections:false,bigKeyIsBox:true,steelDoorWithoutKey:false,itemFirstText:false,equipment:false,equipboxButton:false,iconInEquipbox:false,enableAddPoint:false,enableNegativeDamage:false,hatredDecrease:true,betweenAttackCeil:false,betweenAttackMax:false,useLoop:false,startUsingCanvas:false,startDirectly:true,statusCanvas:false,statusCanvasRowsOnMobile:3,displayEnemyDamage:true,displayCritical:true,displayExtraDamage:false,enableGentleClick:true,potionWhileRouting:false,ignoreChangeFloor:false,canGoDeadZone:false,enableMoveDirectly:true,enableDisabledShop:true,disableShopOnDamage:false,checkConsole:false}};var enemys_fcae963b_31c9_42b4_b48c_bb48d09f3f80={greenSlime:{name:"绿头怪",hp:50,atk:20,def:1,money:1,experience:1,special:0},redSlime:{name:"红头怪",hp:70,atk:15,def:2,money:2,experience:2,special:0},blackSlime:{name:"青头怪",hp:200,atk:35,def:10,money:5,experience:5,special:0},slimelord:{name:"怪王",hp:700,atk:250,def:125,money:32,experience:30,special:0},bat:{name:"小蝙蝠",hp:100,atk:20,def:5,money:3,experience:3,special:0},bigBat:{name:"大蝙蝠",hp:150,atk:65,def:30,money:10,experience:8,special:0},redBat:{name:"红蝙蝠",hp:550,atk:160,def:90,money:25,experience:20,special:0},vampire:{name:"冥灵魔王",hp:30000,atk:1700,def:1500,money:250,experience:220,special:0},vampire2:{name:"冥灵魔王",hp:45000,atk:2550,def:2250,money:312,experience:275,special:0},vampire3:{name:"冥灵魔王",hp:60000,atk:3400,def:3000,money:390,experience:343,special:0},skeleton:{name:"骷髅人",hp:110,atk:25,def:5,money:5,experience:4,special:0},skeletonSoilder:{name:"骷髅士兵",hp:150,atk:40,def:20,money:8,experience:6,special:0},skeletonCaptain:{name:"骷髅队长",hp:400,atk:90,def:50,money:15,experience:12,special:0},ghostSkeleton:{name:"冥队长",hp:2500,atk:900,def:850,money:84,experience:75,special:0},zombie:{name:"兽面人",hp:300,atk:75,def:45,money:13,experience:10,special:0},zombieKnight:{name:"兽面武士",hp:900,atk:450,def:330,money:50,experience:50,special:0},rock:{name:"石头人",hp:500,atk:115,def:65,money:15,experience:15,special:0},slimeMan:{name:"影子战士",hp:3100,atk:1150,def:1050,money:92,experience:80,special:0},bluePriest:{name:"初级法师",hp:125,atk:50,def:25,money:10,experience:7,special:0},redPriest:{name:"高级法师",hp:100,atk:200,def:110,money:30,experience:25,special:0},brownWizard:{name:"麻衣法师",hp:250,atk:120,def:70,money:20,experience:17,special:22,damage:100},redWizard:{name:"红衣法师",hp:500,atk:400,def:260,money:47,experience:45,special:22,damage:300},yellowGuard:{name:"初级卫兵",hp:450,atk:150,def:90,money:22,experience:19,special:0},blueGuard:{name:"中级卫兵",hp:1250,atk:500,def:400,money:55,experience:55,special:0},redGuard:{name:"高级卫兵",hp:1500,atk:560,def:460,money:60,experience:60,special:0},swordsman:{name:"双手剑士",hp:1200,atk:620,def:520,money:65,experience:75,special:0},soldier:{name:"冥战士",hp:2000,atk:680,def:590,money:70,experience:65,special:0},yellowKnight:{name:"金卫士",hp:850,atk:350,def:200,money:45,experience:40,special:0},redKnight:{name:"金队长",hp:900,atk:750,def:650,money:77,experience:70,special:0},darkKnight:{name:"灵武士",hp:1200,atk:980,def:900,money:88,experience:75,point:0,special:0},blackKing:{name:"黑衣魔王",hp:1000,atk:500,def:0,money:1000,experience:1000,point:0,special:0,notBomb:true},yellowKing:{name:"黄衣魔王",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},greenKing:{name:"青衣武士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},blueKnight:{name:"蓝骑士",hp:100,atk:120,def:0,money:9,experience:0,point:0,special:8},goldSlime:{name:"黄头怪",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},poisonSkeleton:{name:"紫骷髅",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},poisonBat:{name:"紫蝙蝠",hp:100,atk:120,def:0,money:14,experience:0,point:0,special:13},steelRock:{name:"铁面人",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},skeletonPriest:{name:"骷髅法师",hp:100,atk:100,def:0,money:0,experience:0,point:0,special:18,value:20},skeletonKing:{name:"骷髅王",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},skeletonWizard:{name:"骷髅巫师",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},redSkeletonCaption:{name:"骷髅武士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},badHero:{name:"迷失勇者",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},demon:{name:"魔神武士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},demonPriest:{name:"魔神法师",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},goldHornSlime:{name:"金角怪",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},redKing:{name:"红衣魔王",hp:15000,atk:1000,def:1000,money:100,experience:100,point:0,special:0},whiteKing:{name:"白衣武士",hp:1300,atk:300,def:150,money:40,experience:35,point:0,special:11,value:4},blackMagician:{name:"灵法师",hp:1500,atk:830,def:730,money:80,experience:70,point:0,special:11,value:3,add:false,notBomb:false},silverSlime:{name:"银头怪",hp:100,atk:120,def:0,money:15,experience:0,point:0,special:14},swordEmperor:{name:"剑圣",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},whiteHornSlime:{name:"尖角怪",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},badPrincess:{name:"痛苦魔女",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},badFairy:{name:"黑暗仙子",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},grayPriest:{name:"中级法师",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},redSwordsman:{name:"剑王",hp:100,atk:120,def:0,money:7,experience:0,point:0,special:6,n:8},whiteGhost:{name:"水银战士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},poisonZombie:{name:"绿兽人",hp:100,atk:120,def:0,money:13,experience:0,point:0,special:12},magicDragon:{name:"魔龙",hp:99999,atk:9999,def:5000,money:0,experience:0,special:0,point:0},octopus:{name:"血影",hp:99999,atk:5000,def:4000,money:0,experience:0,point:0,special:0},darkFairy:{name:"仙子",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},greenKnight:{name:"强盾骑士",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},angel:{name:"天使",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},elemental:{name:"元素生物",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:0},steelGuard:{name:"铁守卫",hp:0,atk:0,def:0,money:0,experience:0,point:0,special:18,value:20},evilBat:{name:"邪恶蝙蝠",hp:1000,atk:1,def:0,money:0,experience:0,point:0,special:[2,3]}};var icons_4665ee12_3a1f_44a4_bea3_0fccba634dc1={hero:{down:{loc:0,stop:0,leftFoot:1,rightFoot:3},left:{loc:1,stop:0,leftFoot:1,rightFoot:3},right:{loc:2,stop:0,leftFoot:1,rightFoot:3},up:{loc:3,stop:0,leftFoot:1,rightFoot:3},width:32,height:48},terrains:{ground:0,grass:1,grass2:2,yellowWall:3,whiteWall:4,blueWall:5,snowGround:6,ground2:7,ground3:8,ground4:9,sand:10,ground5:11,yellowWall2:12,whiteWall2:13,blueWall2:14,blockWall:15,grayWall:16,white:17,ground6:18,soil:19,ground7:20,ground8:21,ice:22,downFloor:23,upFloor:24,yellowDoor:25,blueDoor:26,redDoor:27,greenDoor:28,specialDoor:29,steelDoor:30,"blueShop-left":31,"blueShop-right":32,"pinkShop-left":33,"pinkShop-right":34,arrowUp:35,arrowDown:36,arrowLeft:37,arrowRight:38,light:39,darkLight:40,ski:41,flower:42,box:43,boxed:44},animates:{star:0,lava:1,blueWater:2,water:3,yellowDoor:4,blueDoor:5,redDoor:6,greenDoor:7,specialDoor:8,steelDoor:9,yellowWall:10,whiteWall:11,blueWall:12,crystalUp:13,crystalBottom:14,starPortal:15,fire:16,portal:17,"switch":18,lavaNet:19,poisonNet:20,weakNet:21,curseNet:22,downPortal:23,leftPortal:24,rightPortal:25,upPortal:26},npcs:{man:0,woman:1,thief:2,fairy:3,magician:4,womanMagician:5,oldMan:6,child:7,wood:8,pinkShop:9,blueShop:10,princess:11,wlt:12,wt:13,wrt:14,wl:15,wc:16,wr:17,wlb:18,wrb:19,dlt:20,dt:21,drt:22,dl:23,dc:24,dr:25,dlb:26,drb:27},npc48:{npc0:0,npc1:1,npc2:2,npc3:3,npc4:4},enemys:{greenSlime:0,redSlime:1,blackSlime:2,slimelord:3,bat:4,bigBat:5,redBat:6,vampire:7,skeleton:8,skeletonSoilder:9,skeletonCaptain:10,ghostSkeleton:11,zombie:12,zombieKnight:13,rock:14,slimeMan:15,bluePriest:16,redPriest:17,brownWizard:18,redWizard:19,yellowGuard:20,blueGuard:21,redGuard:22,swordsman:23,soldier:24,yellowKnight:25,redKnight:26,darkKnight:27,blackKing:28,yellowKing:29,greenKing:30,blueKnight:31,goldSlime:32,poisonSkeleton:33,poisonBat:34,steelRock:35,skeletonPriest:36,skeletonKing:37,skeletonWizard:38,redSkeletonCaption:39,badHero:40,demon:41,demonPriest:42,goldHornSlime:43,redKing:44,whiteKing:45,blackMagician:46,silverSlime:47,swordEmperor:48,whiteHornSlime:49,badPrincess:50,badFairy:51,grayPriest:52,redSwordsman:53,whiteGhost:54,poisonZombie:55,magicDragon:56,octopus:57,darkFairy:58,greenKnight:59},enemy48:{angel:0,elemental:1,steelGuard:2,evilBat:3},items:{yellowKey:0,blueKey:1,redKey:2,greenKey:3,steelKey:4,bigKey:6,redJewel:16,blueJewel:17,greenJewel:18,yellowJewel:19,redPotion:20,bluePotion:21,greenPotion:22,yellowPotion:23,lifeWand:33,sword0:60,sword1:50,sword2:51,sword3:52,sword4:53,sword5:54,shield0:61,shield1:55,shield2:56,shield3:57,shield4:58,shield5:59,book:9,fly:12,pickaxe:45,icePickaxe:44,bomb:43,centerFly:13,upFly:15,downFly:14,coin:11,snow:41,cross:40,superPotion:29,earthquake:8,poisonWine:24,weakWine:25,curseWine:27,superWine:28,knife:42,moneyPocket:46,shoes:47,hammer:48,jumpShoes:49,skill1:30,wand:10},autotile:{autotile:0,autotile1:0,autotile2:0,autotile3:0}};var maps_90f36752_8815_4be8_b32b_d7fad1d0542e={"1":{cls:"terrains",id:"yellowWall",canBreak:true},"2":{cls:"terrains",id:"whiteWall",canBreak:true},"3":{cls:"terrains",id:"blueWall",canBreak:true},"4":{cls:"animates",id:"star",noPass:true},"5":{cls:"animates",id:"lava",noPass:true},"6":{cls:"terrains",id:"ice"},"7":{cls:"terrains",id:"blueShop-left"},"8":{cls:"terrains",id:"blueShop-right"},"9":{cls:"terrains",id:"pinkShop-left"},"10":{cls:"terrains",id:"pinkShop-right"},"11":{cls:"animates",id:"lavaNet",noPass:false,trigger:"passNet"},"12":{cls:"animates",id:"poisonNet",noPass:false,trigger:"passNet"},"13":{cls:"animates",id:"weakNet",noPass:false,trigger:"passNet"},"14":{cls:"animates",id:"curseNet",noPass:false,trigger:"passNet"},"15":{cls:"animates",id:"blueWater",noPass:true},"16":{cls:"animates",id:"water",noPass:true},"20":{cls:"autotile",id:"autotile",noPass:true},"21":{cls:"items",id:"yellowKey"},"22":{cls:"items",id:"blueKey"},"23":{cls:"items",id:"redKey"},"24":{cls:"items",id:"greenKey"},"25":{cls:"items",id:"steelKey"},"26":{cls:"items",id:"bigKey"},"27":{cls:"items",id:"redJewel"},"28":{cls:"items",id:"blueJewel"},"29":{cls:"items",id:"greenJewel"},"30":{cls:"items",id:"yellowJewel"},"31":{cls:"items",id:"redPotion"},"32":{cls:"items",id:"bluePotion"},"33":{cls:"items",id:"greenPotion"},"34":{cls:"items",id:"yellowPotion"},"35":{cls:"items",id:"sword1"},"36":{cls:"items",id:"shield1"},"37":{cls:"items",id:"sword2"},"38":{cls:"items",id:"shield2"},"39":{cls:"items",id:"sword3"},"40":{cls:"items",id:"shield3"},"41":{cls:"items",id:"sword4"},"42":{cls:"items",id:"shield4"},"43":{cls:"items",id:"sword5"},"44":{cls:"items",id:"shield5"},"45":{cls:"items",id:"book"},"46":{cls:"items",id:"fly"},"47":{cls:"items",id:"pickaxe"},"48":{cls:"items",id:"icePickaxe"},"49":{cls:"items",id:"bomb"},"50":{cls:"items",id:"centerFly"},"51":{cls:"items",id:"upFly"},"52":{cls:"items",id:"downFly"},"53":{cls:"items",id:"coin"},"54":{cls:"items",id:"snow"},"55":{cls:"items",id:"cross"},"56":{cls:"items",id:"superPotion"},"57":{cls:"items",id:"earthquake"},"58":{cls:"items",id:"poisonWine"},"59":{cls:"items",id:"weakWine"},"60":{cls:"items",id:"curseWine"},"61":{cls:"items",id:"superWine"},"62":{cls:"items",id:"knife"},"63":{cls:"items",id:"moneyPocket"},"64":{cls:"items",id:"shoes"},"65":{cls:"items",id:"hammer"},"68":{cls:"items",id:"lifeWand"},"69":{cls:"items",id:"jumpShoes"},"70":{cls:"items",id:"sword0"},"71":{cls:"items",id:"shield0"},"72":{cls:"items",id:"skill1"},"73":{cls:"items",id:"wand"},"81":{cls:"terrains",id:"yellowDoor",trigger:"openDoor"},"82":{cls:"terrains",id:"blueDoor",trigger:"openDoor"},"83":{cls:"terrains",id:"redDoor",trigger:"openDoor"},"84":{cls:"terrains",id:"greenDoor",trigger:"openDoor"},"85":{cls:"terrains",id:"specialDoor",trigger:"openDoor"},"86":{cls:"terrains",id:"steelDoor",trigger:"openDoor"},"87":{cls:"terrains",id:"upFloor",noPass:false},"88":{cls:"terrains",id:"downFloor",noPass:false},"89":{cls:"animates",id:"portal",noPass:false},"90":{cls:"animates",id:"starPortal",noPass:false},"91":{cls:"animates",id:"upPortal",noPass:false},"92":{cls:"animates",id:"leftPortal",noPass:false},"93":{cls:"animates",id:"downPortal",noPass:false},"94":{cls:"animates",id:"rightPortal",noPass:false},"101":{cls:"animates",id:"crystalUp"},"102":{cls:"animates",id:"crystalBottom"},"103":{cls:"animates",id:"fire"},"104":{cls:"animates",id:"switch"},"121":{cls:"npcs",id:"man",name:"神秘老人："},"122":{cls:"npcs",id:"woman",name:"商人："},"123":{cls:"npcs",id:"thief",name:"小偷："},"124":{cls:"npcs",id:"fairy",name:"仙子："},"125":{cls:"npcs",id:"magician"},"126":{cls:"npcs",id:"womanMagician"},"127":{cls:"npcs",id:"oldMan"},"128":{cls:"npcs",id:"child"},"129":{cls:"npcs",id:"wood"},"130":{cls:"npcs",id:"pinkShop"},"131":{cls:"npcs",id:"blueShop"},"132":{cls:"npcs",id:"princess",name:"公主："},"133":{cls:"npc48",id:"npc0"},"134":{cls:"npc48",id:"npc1"},"135":{cls:"npc48",id:"npc2"},"136":{cls:"npc48",id:"npc3"},"137":{cls:"npc48",id:"npc4"},"151":{cls:"autotile",id:"autotile1",noPass:true},"152":{cls:"autotile",id:"autotile2",noPass:true},"153":{cls:"autotile",id:"autotile3",noPass:true},"161":{cls:"terrains",id:"arrowUp",noPass:false,cannotOut:["left","right","down"],cannotIn:["down"]},"162":{cls:"terrains",id:"arrowDown",noPass:false,cannotOut:["left","right","up"],cannotIn:["up"]},"163":{cls:"terrains",id:"arrowLeft",noPass:false,cannotOut:["up","down","right"],cannotIn:["right"]},"164":{cls:"terrains",id:"arrowRight",noPass:false,cannotOut:["up","down","left"],cannotIn:["left"]},"165":{cls:"terrains",id:"light",trigger:"changeLight",noPass:false},"166":{cls:"terrains",id:"darkLight",noPass:true},"167":{cls:"terrains",id:"ski",trigger:"ski",noPass:false},"168":{cls:"terrains",id:"flower",noPass:false},"169":{cls:"terrains",id:"box",trigger:"pushBox",noPass:true},"170":{cls:"terrains",id:"boxed",trigger:"pushBox",noPass:true},"181":{cls:"npcs",id:"wlt"},"182":{cls:"npcs",id:"wt"},"183":{cls:"npcs",id:"wrt"},"184":{cls:"npcs",id:"wl"},"185":{cls:"npcs",id:"wc"},"186":{cls:"npcs",id:"wr"},"187":{cls:"npcs",id:"wlb"},"188":{cls:"npcs",id:"wrb"},"189":{cls:"npcs",id:"dlt"},"190":{cls:"npcs",id:"dt"},"191":{cls:"npcs",id:"drt"},"192":{cls:"npcs",id:"dl"},"193":{cls:"npcs",id:"dc"},"194":{cls:"npcs",id:"dr"},"195":{cls:"npcs",id:"dlb"},"196":{cls:"npcs",id:"drb"},"201":{cls:"enemys",id:"greenSlime"},"202":{cls:"enemys",id:"redSlime"},"203":{cls:"enemys",id:"blackSlime"},"204":{cls:"enemys",id:"slimelord"},"205":{cls:"enemys",id:"bat"},"206":{cls:"enemys",id:"bigBat"},"207":{cls:"enemys",id:"redBat"},"208":{cls:"enemys",id:"vampire"},"209":{cls:"enemys",id:"skeleton"},"210":{cls:"enemys",id:"skeletonSoilder"},"211":{cls:"enemys",id:"skeletonCaptain"},"212":{cls:"enemys",id:"ghostSkeleton"},"213":{cls:"enemys",id:"zombie"},"214":{cls:"enemys",id:"zombieKnight"},"215":{cls:"enemys",id:"rock"},"216":{cls:"enemys",id:"slimeMan"},"217":{cls:"enemys",id:"bluePriest"},"218":{cls:"enemys",id:"redPriest"},"219":{cls:"enemys",id:"brownWizard"},"220":{cls:"enemys",id:"redWizard"},"221":{cls:"enemys",id:"yellowGuard"},"222":{cls:"enemys",id:"blueGuard"},"223":{cls:"enemys",id:"redGuard"},"224":{cls:"enemys",id:"swordsman"},"225":{cls:"enemys",id:"soldier"},"226":{cls:"enemys",id:"yellowKnight"},"227":{cls:"enemys",id:"redKnight"},"228":{cls:"enemys",id:"darkKnight"},"229":{cls:"enemys",id:"blackKing"},"230":{cls:"enemys",id:"yellowKing"},"231":{cls:"enemys",id:"greenKing"},"232":{cls:"enemys",id:"blueKnight"},"233":{cls:"enemys",id:"goldSlime"},"234":{cls:"enemys",id:"poisonSkeleton"},"235":{cls:"enemys",id:"poisonBat"},"236":{cls:"enemys",id:"steelRock"},"237":{cls:"enemys",id:"skeletonPriest"},"238":{cls:"enemys",id:"skeletonKing"},"239":{cls:"enemys",id:"skeletonWizard"},"240":{cls:"enemys",id:"redSkeletonCaption"},"241":{cls:"enemys",id:"badHero"},"242":{cls:"enemys",id:"demon"},"243":{cls:"enemys",id:"demonPriest"},"244":{cls:"enemys",id:"goldHornSlime"},"245":{cls:"enemys",id:"redKing"},"246":{cls:"enemys",id:"whiteKing"},"247":{cls:"enemys",id:"blackMagician"},"248":{cls:"enemys",id:"silverSlime"},"249":{cls:"enemys",id:"swordEmperor"},"250":{cls:"enemys",id:"whiteHornSlime"},"251":{cls:"enemys",id:"badPrincess"},"252":{cls:"enemys",id:"badFairy"},"253":{cls:"enemys",id:"grayPriest"},"254":{cls:"enemys",id:"redSwordsman"},"255":{cls:"enemys",id:"whiteGhost"},"256":{cls:"enemys",id:"poisonZombie"},"257":{cls:"enemys",id:"magicDragon"},"258":{cls:"enemys",id:"octopus"},"259":{cls:"enemys",id:"darkFairy"},"260":{cls:"enemys",id:"greenKnight"},"261":{cls:"enemy48",id:"angel"},"262":{cls:"enemy48",id:"elemental"},"263":{cls:"enemy48",id:"steelGuard"},"264":{cls:"enemy48",id:"evilBat"}};var items_296f5d02_12fd_4166_a7c1_b5e830c9ee3a={items:{yellowKey:{cls:"keys",name:"黄钥匙",text:"可以打开一扇黄门"},blueKey:{cls:"keys",name:"蓝钥匙",text:"可以打开一扇蓝门"},redKey:{cls:"keys",name:"红钥匙",text:"可以打开一扇红门"},redJewel:{cls:"items",name:"红宝石",text:"'，攻击+'+core.values.redJewel"},blueJewel:{cls:"items",name:"蓝宝石",text:"'，防御+'+core.values.blueJewel"},greenJewel:{cls:"items",name:"绿宝石",text:"'，魔防+'+core.values.greenJewel"},yellowJewel:{cls:"items",name:"黄宝石",text:"可以进行加点"},redPotion:{cls:"items",name:"小血瓶",text:"'，生命+'+core.values.redPotion"},bluePotion:{cls:"items",name:"大血瓶",text:"'，生命+'+core.values.bluePotion"},yellowPotion:{cls:"items",name:"黄血瓶",text:"'生命+'+core.values.yellowPotion"},greenPotion:{cls:"items",name:"绿血瓶",text:"'，生命+'+core.values.greenPotion"},sword0:{cls:"items",name:"破旧的剑",text:"一把已经生锈的剑",equip:{type:0,atk:0,animate:"sword"}},sword1:{cls:"items",name:"铁剑",text:"一把很普通的铁剑",equip:{type:0,atk:10,animate:"sword"}},sword2:{cls:"items",name:"银剑",text:"一把很普通的银剑",equip:{type:0,atk:20,animate:"sword"}},sword3:{cls:"items",name:"青锋剑",text:"一把很普通的骑士剑",equip:{type:0,atk:40,animate:"sword"}},sword4:{cls:"items",name:"圣剑",text:"一把很普通的圣剑",equip:{type:0,atk:80,animate:"sword"}},sword5:{cls:"items",name:"星光神剑",text:"一把很普通的神圣剑",equip:{type:0,atk:100,animate:"sword"}},shield0:{cls:"items",name:"破旧的盾",text:"一个很破旧的铁盾",equip:{type:1,def:0}},shield1:{cls:"items",name:"铁盾",text:"一个很普通的铁盾",equip:{type:1,def:10}},shield2:{cls:"items",name:"银盾",text:"一个很普通的银盾",equip:{type:1,def:20}},shield3:{cls:"items",name:"黄金盾",text:"一个很普通的骑士盾",equip:{type:1,def:40}},shield4:{cls:"items",name:"圣盾",text:"一个很普通的圣盾",equip:{type:1,def:80}},shield5:{cls:"items",name:"光芒神盾",text:"一个很普通的神圣盾",equip:{type:1,def:100,mdef:100}},superPotion:{cls:"items",name:"圣水瓶"},moneyPocket:{cls:"items",name:"金块"},book:{cls:"constants",name:"圣光徽",text:"该宝物可以查看怪物的基本情况。使用时按下键盘上的L键便可查看，然后按X键则取消显示。"},fly:{cls:"constants",name:"风之罗盘",text:"该宝物可以随意在已经走过的楼层间自由上下。主角可使用J键在已经走过的楼层间进行跳跃。",hideInReplay:true},coin:{cls:"constants",name:"幸运金币",text:"持有时打败怪物可得双倍金币"},snow:{cls:"constants",name:"冰冻徽章",text:"可以将面前的熔岩变成平地"},cross:{cls:"constants",name:"幸运十字架",text:"把它交给序章中的仙子，可以将自身的所有能力提升一些（攻击、防御和生命值）。"},knife:{cls:"constants",name:"屠龙匕首",text:"该道具尚未被定义"},shoes:{cls:"constants",name:"绿鞋",text:"持有时无视负面地形"},bigKey:{cls:"tools",name:"大黄门钥匙",text:"可以开启当前层所有黄门"},greenKey:{cls:"tools",name:"绿钥匙",text:"可以打开一扇绿门"},steelKey:{cls:"tools",name:"铁门钥匙",text:"可以打开一扇铁门"},pickaxe:{cls:"tools",name:"破墙镐",text:"可以破坏勇士面前的墙"},icePickaxe:{cls:"constants",name:"星光神锒",text:"把它交给第四层的小偷，小偷便会用它打开第十八层的隐藏地面（你就可以救出公主了）。"},bomb:{cls:"tools",name:"炸弹",text:"可以炸掉勇士面前的怪物"},centerFly:{cls:"items",name:"小飞羽",text:"可以飞向当前楼层中心对称的位置"},upFly:{cls:"tools",name:"上楼器",text:"可以飞往楼上的相同位置"},downFly:{cls:"tools",name:"下楼器",text:"可以飞往楼下的相同位置"},earthquake:{cls:"tools",name:"地震卷轴",text:"可以破坏当前层的所有墙"},poisonWine:{cls:"tools",name:"解毒药水",text:"可以解除中毒状态"},weakWine:{cls:"tools",name:"解衰药水",text:"可以解除衰弱状态"},curseWine:{cls:"tools",name:"解咒药水",text:"可以解除诅咒状态"},superWine:{cls:"tools",name:"万能药水",text:"可以解除所有不良状态"},hammer:{cls:"tools",name:"圣锤",text:"可以炸掉勇士面前的怪物"},lifeWand:{cls:"tools",name:"生命魔杖",text:"可以恢复100点生命值"},jumpShoes:{cls:"tools",name:"跳跃靴",text:"能跳跃到前方两格处"},skill1:{cls:"constants",name:"技能：二倍斩",text:"可以打开或关闭主动技能二倍斩",hideInReplay:true},wand:{cls:"items",name:"新物品"}},itemEffect:{redJewel:"core.status.hero.atk += core.values.redJewel * ratio",blueJewel:"core.status.hero.def += core.values.blueJewel * ratio",greenJewel:"core.status.hero.mdef += core.values.greenJewel * ratio",yellowJewel:"core.status.hero.hp+=1000;core.status.hero.atk+=6;core.status.hero.def+=6;core.status.hero.mdef+=10;",redPotion:"core.status.hero.hp += core.values.redPotion * ratio",bluePotion:"core.status.hero.hp += core.values.bluePotion * ratio",yellowPotion:"core.status.hero.hp += core.values.yellowPotion * ratio",greenPotion:"core.status.hero.hp += core.values.greenPotion * ratio",sword0:"core.status.hero.atk += 0",sword1:"core.status.hero.atk += 10",sword2:"core.status.hero.atk += 20",sword3:"core.status.hero.atk += 70",sword4:"core.status.hero.atk += 80",sword5:"core.status.hero.atk += 150",shield0:"core.status.hero.def += 0",shield1:"core.status.hero.def += 10",shield2:"core.status.hero.def += 20",shield3:"core.status.hero.def += 85",shield4:"core.status.hero.def += 80",shield5:"core.status.hero.def += 190",bigKey:"core.status.hero.items.keys.yellowKey++;core.status.hero.items.keys.blueKey++;core.status.hero.items.keys.redKey++;",superPotion:"core.status.hero.hp *= 2",moneyPocket:"core.status.hero.money += 300",centerFly:"++core.status.hero.lv;core.status.hero.hp+=1000;core.status.hero.atk+=10;core.status.hero.def+=10"},itemEffectTip:{redJewel:"'，攻击力加'+core.values.redJewel * ratio",blueJewel:"'，防御力加'+core.values.blueJewel * ratio",greenJewel:"'，魔防+'+core.values.greenJewel * ratio",yellowJewel:"'，全属性提升'",redPotion:"'，生命加'+core.values.redPotion * ratio",bluePotion:"'，生命加'+core.values.bluePotion * ratio",yellowPotion:"'，生命+'+core.values.yellowPotion * ratio",greenPotion:"'，生命+'+core.values.greenPotion * ratio",sword0:"'，攻击+0'",sword1:"'，攻击加10！'",sword2:"'，攻击+20'",sword3:"'，攻击加70！'",sword4:"'，攻击+80'",sword5:"'，攻击加150！'",shield0:"'，防御+0'",shield1:"'，防御加10！'",shield2:"'，防御+20'",shield3:"'，防御加85！'",shield4:"'，防御+80'",shield5:"'，防御加190！'",bigKey:"'，各种钥匙数加1！'",superPotion:"'，它可以将你的体质(生命值)增加一倍。'",moneyPocket:"'，金币数加300！'",centerFly:"'，等级提升一级！'"},useItemEffect:{book:"core.ui.drawBook(0);",fly:"core.ui.drawFly(core.floorIds.indexOf(core.status.floorId));",earthquake:"core.removeBlockByIds(core.status.floorId, core.status.event.ui);\ncore.drawMap(core.status.floorId, function () {\n\tcore.drawTip(core.material.items[itemId].name + '使用成功');\n});",pickaxe:"core.playSound('pickaxe.mp3');\ncore.removeBlockByIds(core.status.floorId, core.status.event.ui);\ncore.drawMap(core.status.floorId, function () {\n\tcore.drawTip(core.material.items[itemId].name + '使用成功');\n});",icePickaxe:"core.removeBlockByIds(core.status.floorId, core.status.event.ui);\ncore.drawMap(core.status.floorId, function () {\n\tcore.drawTip(core.material.items[itemId].name + '使用成功');\n});",snow:"core.removeBlockByIds(core.status.floorId, core.status.event.ui);\ncore.drawMap(core.status.floorId, function () {\n\tcore.drawTip(core.material.items[itemId].name + '使用成功');\n});",bigKey:"core.removeBlockByIds(core.status.floorId, core.status.event.ui);\ncore.drawMap(core.status.floorId, function () {\n\tcore.drawTip(core.material.items[itemId].name + '使用成功');\n});",bomb:"core.playSound('bomb.mp3');\ncore.removeBlockByIds(core.status.floorId, core.status.event.ui);\ncore.drawMap(core.status.floorId, function () {\n\tcore.drawTip(core.material.items[itemId].name + '使用成功');\n\tcore.events.afterUseBomb();\n});",hammer:"core.playSound('bomb.mp3');\ncore.removeBlockByIds(core.status.floorId, core.status.event.ui);\ncore.drawMap(core.status.floorId, function () {\n\tcore.drawTip(core.material.items[itemId].name + '使用成功');\n\tcore.events.afterUseBomb();\n});",centerFly:"core.playSound('centerFly.mp3');\ncore.clearMap('hero');\ncore.setHeroLoc('x', core.bigmap.width-1-core.getHeroLoc('x'));\ncore.setHeroLoc('y', core.bigmap.height-1-core.getHeroLoc('y'));\ncore.drawHero();\ncore.drawTip(core.material.items[itemId].name + '使用成功');",upFly:'var loc = {\'direction\': core.status.hero.loc.direction, \'x\': core.status.event.ui.x, \'y\': core.status.event.ui.y};\nif (core.status.event.id == \'action\') {\n\tcore.insertAction([\n\t\t{"type": "changeFloor", "loc": [loc.x, loc.y], "direction": loc.direction, "floorId": core.status.event.ui.id},\n\t\t{"type": "tip", "text": core.material.items[itemId].name + \'使用成功\'}\n\t]);\n}\nelse {\n\tcore.changeFloor(core.status.event.ui.id, null, loc, null, function (){\n\tcore.drawTip(core.material.items[itemId].name + \'使用成功\');\n\t\tcore.replay();\n\t});\n}',downFly:'var loc = {\'direction\': core.status.hero.loc.direction, \'x\': core.status.event.ui.x, \'y\': core.status.event.ui.y};\nif (core.status.event.id == \'action\') {\n\tcore.insertAction([\n\t\t{"type": "changeFloor", "loc": [loc.x, loc.y], "direction": loc.direction, "floorId": core.status.event.ui.id},\n\t\t{"type": "tip", "text": core.material.items[itemId].name + \'使用成功\'}\n\t]);\n}\nelse {\n\tcore.changeFloor(core.status.event.ui.id, null, loc, null, function (){\n\tcore.drawTip(core.material.items[itemId].name + \'使用成功\');\n\t\tcore.replay();\n\t});\n}\n',poisonWine:"core.removeFlag('poison');",weakWine:'core.removeFlag(\'weak\');\nif (core.values.weakValue>=1) { // >=1：直接扣数值\n\tcore.status.hero.atk += core.values.weakValue;\n\tcore.status.hero.def += core.values.weakValue;\n}\nelse { // <1：扣比例\n\tcore.addBuff("atk", core.values.weakValue);\n\tcore.addBuff("def", core.values.weakValue);\n}',curseWine:"core.removeFlag('curse');",superWine:"core.removeFlag('poison');\nif (core.hasFlag('weak')) {\n\tcore.removeFlag('weak');\n\tif (core.values.weakValue>=1) { // >=1：直接扣数值\n\t\tcore.status.hero.atk += core.values.weakValue;\n\t\tcore.status.hero.def += core.values.weakValue;\n\t}\n\telse { // <1：扣比例\n\t\tcore.addBuff(\"atk\", core.values.weakValue);\n\t\tcore.addBuff(\"def\", core.values.weakValue);\n\t}\n}\ncore.removeFlag('curse');",lifeWand:'core.insertAction([\n\t{"type": "input", "text": "请输入生命魔杖使用次数：(0-${item:lifeWand})"},\n\t{"type": "if", "condition": "flag:input<=item:lifeWand",\n\t\t"true": [\n\t\t\t{"type": "setValue", "name": "item:lifeWand", "value": "item:lifeWand-flag:input"},\n\t\t\t{"type": "setValue", "name": "status:hp", "value": "status:hp+flag:input*100"},\n\t\t\t"成功使用${flag:input}次生命魔杖，恢复${flag:input*100}点生命。"\n\t\t],\n\t\t"false": ["输入不合法！"]\n\t},\n]);\ncore.addItem(\'lifeWand\', 1);',jumpShoes:'core.insertAction({"type":"jumpHero","loc":[core.nextX(2),core.nextY(2)]});',redPotion:"core.status.hero.hp += core.values.redPotion",bluePotion:"core.status.hero.hp += core.values.bluePotion",greenPotion:"core.status.hero.hp += core.values.greenPotion",yellowPotion:"core.status.hero.hp += core.values.yellowPotion",redJewel:"core.status.hero.atk += core.values.redJewel",blueJewel:"core.status.hero.def += core.values.blueJewel",greenJewel:"core.status.hero.mdef += core.values.greenJewel",yellowJewel:'core.insertAction([\n\t{"type": "choices", "choices": [\n\t\t{"text": "攻击+1", "action": [\n\t\t\t{"type": "setValue", "name": "status:atk", "value": "status:atk+1"}\n\t\t]},\n\t\t{"text": "防御+2", "action": [\n\t\t\t{"type": "setValue", "name": "status:def", "value": "status:def+2"}\n\t\t]},\n\t\t{"text": "生命+200", "action": [\n\t\t\t{"type": "setValue", "name": "status:hp", "value": "status:hp+200"}\n\t\t]},\n\t]}\n]);',skill1:"// 二倍斩的flag:skill为1\nif (core.getFlag('skill', 0)==0) { // 判断当前是否已经开了技能\n\tif (core.getStatus('mana')>=5) { // 这里要写当前能否开技能的条件判断，比如魔力值至少要多少\n\t\tcore.setFlag('skill', 1); // 开技能1\n\t\tcore.setFlag('skillName', '二倍斩'); // 设置技能名\n\t}\n\telse {\n\t\tcore.drawTip(\"魔力不足，无法开启技能\");\n\t}\n}\nelse { // 关闭技能\n\tcore.setFlag('skill', 0); // 关闭技能状态\n\tcore.setFlag('skillName', '无');\n}"},canUseItemEffect:{book:"true",fly:"(function () {\n\treturn core.status.maps[core.status.floorId].canFlyTo;\n})();",pickaxe:"(function() {\n\tvar ids = [], id2s = [];\n\tfor (var i in core.status.thisMap.blocks) {\n\t\tvar block = core.status.thisMap.blocks[i];\n\t\tif (!block.disable && core.nearHero(block.x, block.y) && \n\t\t\t(block.event.canBreak || block.event.id == 'yellowWall' || block.event.id=='whiteWall' || block.event.id=='blueWall')) { // 能破哪些墙\n\t\t\t// 四个方向\n\t\t\tif (core.flags.pickaxeFourDirections || (block.x == core.nextX() && block.y == core.nextY()))\n\t\t\t\tids.push(i);\n\t\t\telse id2s.push(i);\n\t\t}\n\t}\n\tif (ids.length>0) {\n\t\tcore.status.event.ui = ids;\n\t\treturn true;\n\t}\n\telse if (id2s.length==1) {\n\t\tcore.status.event.ui = id2s;\n\t\treturn true;\n\t}\n\treturn false;\n})();",icePickaxe:"(function() {\n\tfor (var i in core.status.thisMap.blocks) {\n\t\tvar block = core.status.thisMap.blocks[i];\n\t\tif (!block.disable && block.x==core.nextX() && block.y==core.nextY() && block.event.id=='ice') {\n\t\t\tcore.status.event.ui = [i];\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n})();",bomb:"(function () {\n\tvar ids = [], id2s = [];\n\tfor (var i in core.status.thisMap.blocks) {\n\t\tvar block = core.status.thisMap.blocks[i];\n\t\tif (!block.disable && block.event.cls.indexOf('enemy')==0 && core.nearHero(block.x, block.y)) {\n\t\t\tvar enemy = core.material.enemys[block.event.id];\n\t\t\tif (core.isset(enemy) && enemy.notBomb) continue;\n\t\t\tif (core.flags.bombFourDirections || (block.x==core.nextX() && block.y==core.nextY()))\n\t\t\t\tids.push(i);\n\t\t\telse\n\t\t\t\tid2s.push(i);\n\t\t}\n\t}\n\tif (ids.length>0) {\n\t\tcore.status.event.ui = ids;\n\t\treturn true;\n\t}\n\tif (id2s.length==1) {\n\t\tcore.status.event.ui = id2s;\n\t\treturn true;\n\t}\n\treturn false;\n})();",hammer:"(function() {\n\tvar ids = [], id2s = [];\n\tfor (var i in core.status.thisMap.blocks) {\n\t\tvar block = core.status.thisMap.blocks[i];\n\t\tif (!block.disable && block.event.cls.indexOf('enemy')==0 && core.nearHero(block.x, block.y)) {\n\t\t\tvar enemy = core.material.enemys[block.event.id];\n\t\t\tif (core.isset(enemy) && enemy.notBomb) continue;\n\t\t\tif (block.x==core.nextX() && block.y==core.nextY())\n\t\t\t\tids.push(i);\n\t\t\telse\n\t\t\t\tid2s.push(i);\n\t\t}\n\t}\n\tif (ids.length>0) {\n\t\tcore.status.event.ui = ids;\n\t\treturn true;\n\t}\n\telse if (id2s.length==1) {\n\t\tcore.status.event.ui = id2s;\n\t\treturn true;\n\t}\n\treturn false;\n})();",earthquake:"(function () {\n\tvar able=false;\n\tvar ids = [];\n\tfor (var i in core.status.thisMap.blocks) {\n\t\tvar block = core.status.thisMap.blocks[i];\n\t\tif (!block.disable &&\n\t\t\t(block.event.canBreak || block.event.id == 'yellowWall' || block.event.id == 'blueWall' || block.event.id == 'whiteWall')) { // 能炸的墙壁\n\t\t\tids.push(i);\n\t\t}\n\t}\n\tif (ids.length>0) {\n\t\tcore.status.event.ui = ids;\n\t\table=true;\n\t}\n\treturn able;\n})();",centerFly:"(function () {\n\tvar toX = core.bigmap.width-1-core.getHeroLoc('x'), toY = core.bigmap.height-1-core.getHeroLoc('y');\n\tvar id = core.getBlockId(toX, toY);\n\treturn id == null;\n})();",upFly:"(function() {\n\tvar floorId = core.status.floorId, index = core.floorIds.indexOf(floorId);\n\tif (index<core.floorIds.length-1) {\n\t\tvar toId = core.floorIds[index+1], toX = core.getHeroLoc('x'), toY = core.getHeroLoc('y');\n\t\tvar mw = core.floors[toId].width, mh = core.floors[toId].height;\n\t\tif (toX>=0 && toX<mw && toY>=0 && toY<mh && core.getBlock(toX, toY, toId)==null) {\n\t\t\tcore.status.event.ui = {'id': toId, 'x': toX, 'y': toY};\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n})();",downFly:"(function() {\n\tvar floorId = core.status.floorId, index = core.floorIds.indexOf(floorId);\n\tif (index>0) {\n\t\tvar toId = core.floorIds[index-1], toX = core.getHeroLoc('x'), toY = core.getHeroLoc('y');\n\t\tvar mw = core.floors[toId].width, mh = core.floors[toId].height;\n\t\tif (toX>=0 && toX<mw && toY>=0 && toY<mh && core.getBlock(toX, toY, toId)==null) {\n\t\t\tcore.status.event.ui = {'id': toId, 'x': toX, 'y': toY};\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n})();",snow:"(function () {\n\tvar ids = [], id2s = [];\n\tfor (var i in core.status.thisMap.blocks) {\n\t\tvar block = core.status.thisMap.blocks[i];\n\t\tif (!block.disable && block.event.id == 'lava' && core.nearHero(block.x, block.y)) {\n\t\t\tif (core.flags.snowFourDirections || (block.x == core.nextX() && block.y == core.nextY()))\n\t\t\t\tids.push(i);\n\t\t\telse id2s.push(i);\n\t\t}\n\t}\n\tif (ids.length>0) {\n\t\tcore.status.event.ui = ids;\n\t\treturn true;\n\t}\n\tif (id2s.length==1) {\n\t\tcore.status.event.ui = id2s;\n\t\treturn true;\n\t}\n\treturn false;\n})();",bigKey:"(function() {\n\tvar able=false, ids = [];\n\tfor (var i in core.status.thisMap.blocks) {\n\t\tvar block = core.status.thisMap.blocks[i];\n\t\tif (!block.disable && block.event.id == 'yellowDoor') {\n\t\t\tids.push(i);\n\t\t}\n\t}\n\tif (ids.length>0) {\n\t\tcore.status.event.ui = ids;\n\t\table=true;\n\t}\n\treturn able;\n})();",poisonWine:"core.hasFlag('poison');",weakWine:"core.hasFlag('weak');",curseWine:"core.hasFlag('curse');",superWine:"(function() {\n\treturn core.hasFlag('poison') || core.hasFlag('weak') || core.hasFlag('curse');\n})();",lifeWand:"true",jumpShoes:"(function() {\n\tvar nx=core.nextX(2), ny=core.nextY(2);\n\treturn nx>=0 && nx<core.bigmap.width && ny>=0 && ny<core.bigmap.height && core.getBlockId(nx,ny)==null;\n})();",redPotion:"true",bluePotion:"true",greenPotion:"true",yellowPotion:"true",redJewel:"true",blueJewel:"true",greenJewel:"true",yellowJewel:"true",skill1:"true"},equipCondition:{}};var functions_d6ad677b_427a_4623_b50f_a445a3b0ef8a={events:{resetGame:function(d,c,a,f,g){core.clearStatus();core.status=core.clone(core.initStatus,function(h){return h!="hero"&&h!="maps"});core.status.played=true;core.status.hero=core.clone(d);window.flags=core.status.hero.flags;core.events.setHeroIcon(core.getFlag("heroIcon","hero.png"),true);core.control._initStatistics(core.animateFrame.totalTime);core.status.hero.statistics.totalTime=core.animateFrame.totalTime=Math.max(core.status.hero.statistics.totalTime,core.animateFrame.totalTime);core.status.hero.statistics.start=null;core.status.hard=c||"";core.status.floorId=a;core.status.maps=f;core.material.enemys=core.enemys.getEnemys();core.material.items=core.items.getItems();core.items._resetItems();core.values=core.clone(core.data.values);for(var e in g||{}){core.values[e]=g[e]}core.flags=core.clone(core.data.flags);var b=core.getFlag("globalFlags",{});for(var e in b){core.flags[e]=b[e]}core._init_sys_flags();core.resize();core.updateGlobalAttribute();if(core.hasFlag("hideStatusBar")){core.hideStatusBar(core.hasFlag("showToolbox"))}else{core.showStatusBar()}},setInitData:function(){if(core.status.hard=="Easy"){core.setFlag("hard",1)}if(core.status.hard=="Normal"){core.setFlag("hard",2)}if(core.status.hard=="Hard"){core.setFlag("hard",3)}if(core.status.hard=="Hell"){core.setFlag("hard",4)}core.setFlag("__visited__",{});core.updateEnemys()},win:function(b,a){core.ui.closePanel();var c=core.isReplaying();if(c){core.stopReplay()}core.waitHeroToStop(function(){core.clearMap("all");core.deleteAllCanvas();core.dom.gif2.innerHTML="";core.drawText(["\t["+(b||"恭喜通关")+",hero]你的分数是${status:hp}"],function(){core.events.gameOver(b||"",c,a)})})},lose:function(a){core.ui.closePanel();var b=core.isReplaying();core.stopReplay();core.waitHeroToStop(function(){core.drawText(["\t["+(a||"结局1")+"]你死了。\n如题。"],function(){core.events.gameOver(null,b)})})},changingFloor:function(d,f,e){var c=core.status.floorId||null;if(!core.hasFlag("__leaveLoc__")){core.setFlag("__leaveLoc__",{})}if(c!=null){core.getFlag("__leaveLoc__")[c]=core.status.hero.loc}core.maps.resizeMap(d);if(!e){core.status.maps[d].blocks.forEach(function(h){if(h.disable&&core.enemys.hasSpecial(h.event.id,23)){h.disable=false}})}core.status.hero.loc=f;core.turnHero("down");core.control.gatherFollowers();core.drawMap(d);if(core.status.maps[d].bgm){var a=core.status.maps[d].bgm;if(a instanceof Array){a=a[0]}if(!core.hasFlag("__bgm__")){core.playBgm(a)}}var b=core.getFlag("__color__",null);if(!b&&core.status.maps[d].color){b=core.status.maps[d].color}core.clearMap("curtain");core.status.curtainColor=b;if(b){core.fillRect("curtain",0,0,core.__PIXELS__,core.__PIXELS__,core.arrayToRGBA(b))}var g=core.getFlag("__weather__",null);if(!g&&core.status.maps[d].weather){g=core.status.maps[d].weather}if(g){core.setWeather(g[0],g[1])}else{core.setWeather()}},afterChangeFloor:function(a,b){if(b){core.events.recoverEvents(core.getFlag("__events__"));core.removeFlag("__events__")}else{core.insertAction(core.floors[a].eachArrive);if(!core.hasVisitedFloor(a)){core.insertAction(core.floors[a].firstArrive);core.visitFloor(a)}}},flyTo:function(f,a){var b=core.status.floorId;if(!core.status.maps[b].canFlyTo||!core.status.maps[f].canFlyTo||!core.hasVisitedFloor(f)){core.drawTip("无法飞往"+core.status.maps[f].title+"！");return false}var e=null,d=null;if(core.flags.flyRecordPosition){d=core.getFlag("__leaveLoc__",{})[f]||null}if(d==null){var c=core.floorIds.indexOf(b),g=core.floorIds.indexOf(f);e=(c<=g)?"downFloor":"upFloor";if(c==g&&core.status.maps[b].underGround){e="upFloor"}}core.status.route.push("fly:"+f);core.ui.closePanel();core.changeFloor(f,e,d,null,a);return true},beforeBattle:function(c,f,g){if(f!=null&&g!=null){var e=f+","+g,b=core.status.checkBlock.cache[e]||{},d=b.guards||[];if(d.length>0){core.setFlag("__guards__"+f+"_"+g,d);var a=[];d.forEach(function(h){core.push(a,{type:"jump",from:[h[0],h[1]],to:[f,g],time:300,keep:false,async:true})});core.push(a,[{type:"waitAsync"},{type:"trigger",loc:[f,g]}]);core.insertAction(a);return false}}return true},afterBattle:function(d,o,p,a){var c=core.material.enemys[d];var e="hand",f=(core.status.hero.equipment||[])[0];if(f&&(core.material.items[f].equip||{}).animate){e=core.material.items[f].equip.animate}if(!(core.material.animates[e]||{}).se){core.playSound(c.special?d+".mp3":"attack.mp3")}core.drawAnimate(e,o!=null?o:core.getHeroLoc("x"),p!=null?p:core.getHeroLoc("y"));var b=core.enemys.getDamage(d,o,p);if(b==null){b=core.status.hero.hp+1}core.status.hero.hp-=b;core.status.hero.statistics.battleDamage+=b;core.status.hero.statistics.battle++;if(core.status.hero.hp<=0){core.status.hero.hp=0;core.updateStatusBar();core.events.lose("战斗失败");return}var h=[];if(o!=null&&p!=null){core.removeBlock(o,p);h=core.getFlag("__guards__"+o+"_"+p,[]);core.removeFlag("__guards__"+o+"_"+p)}var j=h.reduce(function(q,r){return q+core.material.enemys[r[2]].money},c.money);if(core.hasItem("coin")){j*=2}if(core.hasFlag("curse")){j=0}core.status.hero.money+=j;core.status.hero.statistics.money+=j;var g=h.reduce(function(q,r){return q+core.material.enemys[r[2]].experience},c.experience);if(core.hasFlag("curse")){g=0}core.status.hero.experience+=g;core.status.hero.statistics.experience+=g;var i="打败 "+c.name;if(core.flags.enableMoney){i+="，金币+"+j}if(core.flags.enableExperience){i+="，经验+"+g}core.drawTip(i);var n=[];var m=c.special;if(core.enemys.hasSpecial(m,12)){core.push(n,[{type:"insert",name:"毒衰咒处理",args:[0]}])}if(core.enemys.hasSpecial(m,13)){core.push(n,[{type:"insert",name:"毒衰咒处理",args:[1]}])}if(core.enemys.hasSpecial(m,14)){core.push(n,[{type:"insert",name:"毒衰咒处理",args:[2]}])}if(core.flags.hatredDecrease&&core.enemys.hasSpecial(m,17)){core.setFlag("hatred",Math.floor(core.getFlag("hatred",0)/2))}if(core.enemys.hasSpecial(m,19)){core.status.hero.hp=1}if(core.enemys.hasSpecial(m,21)){core.status.hero.atk-=(c.atkValue||0);core.status.hero.def-=(c.defValue||0);if(core.status.hero.atk<0){core.status.hero.atk=0}if(core.status.hero.def<0){core.status.hero.def=0}}core.setFlag("hatred",core.getFlag("hatred",0)+core.values.hatred);if(core.flags.enableSkill){var l=core.getFlag("skill",0);if(l==1){core.status.hero.mana-=5}core.setFlag("skill",0);core.setFlag("skillName","无")}core.updateStatusBar();var k=core.material.enemys[d].point;if(core.flags.enableAddPoint&&k>0){core.push(n,[{type:"insert",name:"加点事件",args:[k]}])}core.push(n,core.floors[core.status.floorId].afterBattle[o+","+p]);if(n.length>0){core.insertAction(n,o,p)}if(core.status.event.id==null){core.continueAutomaticRoute()}else{core.clearContinueAutomaticRoute()}if(a){a()}},afterOpenDoor:function(b,e,f,a){var d=[];var c=core.floors[core.status.floorId].afterOpenDoor[e+","+f];if(c){core.unshift(d,c)}if(d.length>0){core.insertAction(d,e,f)}if(core.status.event.id==null){core.continueAutomaticRoute()}else{core.clearContinueAutomaticRoute()}if(a){a()}},afterGetItem:function(c,e,f,a){core.playSound(core.material.items[c].cls=="constants"||c=="superPotion"?"constants.mp3":"item.mp3");var d=[];var b=core.floors[core.status.floorId].afterGetItem[e+","+f];if(b){core.unshift(d,b)}if(d.length>0){core.insertAction(d,e,f)}if(a){a()}},afterChangeLight:function(a,b){},afterPushBox:function(){if(core.searchBlock("box").length==0){}},afterUseBomb:function(){},canUseQuickShop:function(a){if(core.status.thisMap.canUseQuickShop===false){return"当前楼层禁止访问全局商店！"}if(core.status.floorId>"MT13"&&core.status.floorId<"MT3"&&core.status.floorId!="MT2"&&!core.hasItem("fly")){return"十四楼起必须携带风之罗盘才能访问全局商店！"}return null}},enemys:{getSpecials:function(){return[[1,"先攻","怪物首先攻击"],[2,"魔攻","怪物无视勇士的防御"],[3,"坚固","勇士每回合最多只能对怪物造成1点伤害"],[4,"2连击","怪物每回合攻击2次"],[5,"3连击","怪物每回合攻击3次"],[6,function(a){return(a.n||4)+"连击"},function(a){return"怪物每回合攻击"+(a.n||4)+"次"}],[7,"破甲","战斗前，怪物附加角色防御的"+Math.floor(100*core.values.breakArmor||0)+"%作为伤害"],[8,"反击","战斗时，怪物每回合附加角色攻击的"+Math.floor(100*core.values.counterAttack||0)+"%作为伤害，无视角色防御"],[9,"净化","战斗前，怪物附加勇士魔防的"+core.values.purify+"倍作为伤害"],[10,"模仿","怪物的攻防和勇士攻防相等"],[11,"吸血",function(a){return"战斗前，怪物首先吸取角色的1/"+a.value+"生命（"+Math.floor(core.getStatus("hp")/a.value)+"点）作为伤害"+(a.add?"，并把伤害数值加到自身生命上":"")}],[12,"中毒","战斗后，勇士陷入中毒状态，每一步损失生命"+core.values.poisonDamage+"点"],[13,"衰弱","战斗后，勇士陷入衰弱状态，攻防暂时下降"+(core.values.weakValue>=1?core.values.weakValue+"点":parseInt(core.values.weakValue*100)+"%")],[14,"诅咒","战斗后，勇士陷入诅咒状态，战斗无法获得金币和经验"],[15,"领域",function(a){return"经过怪物周围"+(a.zoneSquare?"九宫格":"十字")+"范围内"+(a.range||1)+"格时自动减生命"+(a.value||0)+"点"}],[16,"夹击","经过两只相同的怪物中间，勇士生命值变成一半"],[17,"仇恨","战斗前，怪物附加之前积累的仇恨值作为伤害"+(core.flags.hatredDecrease?"；战斗后，释放一半的仇恨值":"")+"。（每杀死一个怪物获得"+(core.values.hatred||0)+"点仇恨值）"],[18,"阻击",function(a){return"经过怪物的十字领域时自动减生命"+(a.value||0)+"点，同时怪物后退一格"}],[19,"自爆","战斗后勇士的生命值变成1"],[20,"无敌","勇士无法打败怪物，除非拥有十字架"],[21,"退化",function(a){return"战斗后勇士永久下降"+(a.atkValue||0)+"点攻击和"+(a.defValue||0)+"点防御"}],[22,"固伤",function(a){return"战斗前，怪物对勇士造成"+(a.damage||0)+"点固定伤害，无视勇士魔防。"}],[23,"重生","怪物被击败后，角色转换楼层则怪物将再次出现"],[24,"激光",function(a){return"经过怪物同行或同列时自动减生命"+(a.value||0)+"点"}],[25,"光环",function(a){return"同楼层所有怪物生命提升"+(a.value||0)+"%，攻击提升"+(a.atkValue||0)+"%，防御提升"+(a.defValue||0)+"%，"+(a.add?"可叠加":"不可叠加")}],[26,"支援","当周围一圈的怪物受到攻击时将上前支援，并组成小队战斗。"],[27,"捕捉","当走到怪物周围十字时会强制进行战斗。"]]},getEnemyInfo:function(e,h,w,z,f){f=f||core.status.floorId;var k=core.getRealStatusOrDefault(h,"hp"),i=core.getRealStatusOrDefault(h,"atk"),j=core.getRealStatusOrDefault(h,"def"),l=core.getRealStatusOrDefault(h,"mdef");var r=e.hp,o=e.atk,p=e.def,u=e.special;var s=e.money,q=e.experience,t=e.point;if(core.hasSpecial(u,10)){o=i;p=j}if(core.hasSpecial(u,3)&&p<i-1){p=i-1}var g=[];var v=function(){var x=["MTx"];return core.inArray(x,f)};if(v()){var m=0,a=0,d=0,c=0;var n=w!=null&&z!=null?(w+","+z):"floor";if(!core.status.checkBlock){core.status.checkBlock={}}if(!core.status.checkBlock.cache){core.status.checkBlock.cache={}}var b=core.status.checkBlock.cache[n];if(!b){core.status.maps[f].blocks.forEach(function(x){if(!x.disable){var A=x.event.id,y=core.material.enemys[A];if(y&&core.hasSpecial(y.special,25)){if(y.add||c==0){m+=y.value||0;a+=y.atkValue||0;d+=y.defValue||0;c++}}if(y&&core.hasSpecial(y.special,26)&&w!=null&&z!=null&&Math.abs(x.x-w)<=1&&Math.abs(x.y-z)<=1&&!(w==x.x&&z==x.y)){g.push([x.x,x.y,A])}}});core.status.checkBlock.cache[n]={hp_buff:m,atk_buff:a,def_buff:d,guards:g}}else{m=b.hp_buff;a=b.atk_buff;d=b.def_buff;g=b.guards}r*=(1+m/100);o*=(1+a/100);p*=(1+d/100)}return{hp:Math.floor(r),atk:Math.floor(o),def:Math.floor(p),money:Math.floor(s),experience:Math.floor(q),point:Math.floor(t),special:u,guards:g,}},getDamageInfo:function(c,l,G,H,e){e=e||core.status.floorId;var o=core.getRealStatusOrDefault(l,"hp"),m=core.getRealStatusOrDefault(l,"atk"),n=core.getRealStatusOrDefault(l,"def"),p=core.getRealStatusOrDefault(l,"mdef"),C=o,A=m,B=n;o=Math.max(0,o);m=Math.max(0,m);n=Math.max(0,n);p=Math.max(0,p);var d=core.enemys.getEnemyInfo(c,l,G,H,e);var w=d.hp,u=d.atk,v=d.def,z=d.special;if(core.getFlag("skill",0)==1){m*=2}if(core.hasSpecial(z,20)&&!core.hasItem("cross")){return null}var t=0;if(core.hasSpecial(z,11)){var F=o/c.value;F=Math.floor(F)||0;if(c.add){w+=F}t+=F}var D=u-n;if(core.hasSpecial(z,2)){D=u}if(D<0){D=0}if(core.hasSpecial(z,4)){D*=2}if(core.hasSpecial(z,5)){D*=3}if(core.hasSpecial(z,6)){D*=(c.n||4)}var a=0;if(core.hasSpecial(z,8)){a+=Math.floor(core.values.counterAttack*m)}if(core.hasSpecial(z,1)){t+=D}if(core.hasSpecial(z,7)){t+=Math.floor(core.values.breakArmor*n)}if(core.hasSpecial(z,9)){t+=Math.floor(core.values.purify*p)}var q=Math.max(m-v,0);if(q<=0){return null}var E=Math.ceil(w/q);var h=core.getFlag("__guards__"+G+"_"+H,d.guards);var g=false;E+=core.getFlag("__extraTurn__",0);if(h.length>0){if(!g){core.setFlag("__extraTurn__",E)}for(var r=0;r<h.length;r++){var j=h[r][0],k=h[r][1],f=h[r][2];var s=core.enemys.getDamageInfo(core.material.enemys[f],{hp:C,atk:A,def:B,mdef:0});if(s==null){return null}core.setFlag("__extraTurn__",s.turn);t+=s.damage}if(g){E+=core.getFlag("__extraTurn__",0)}}core.removeFlag("__extraTurn__");var b=t+(E-1)*D+E*a;b-=p;if(!core.flags.enableNegativeDamage){b=Math.max(0,b)}return{mon_hp:Math.floor(w),mon_atk:Math.floor(u),mon_def:Math.floor(v),init_damage:Math.floor(t),per_damage:Math.floor(D),hero_per_damage:Math.floor(q),turn:Math.floor(E),damage:Math.floor(b)}},updateEnemys:function(){if(!core.getBlock(6,6,"MT16")){core.material.enemys.darkKnight.hp=1600;core.material.enemys.darkKnight.atk=1306;core.material.enemys.darkKnight.def=1200;core.material.enemys.darkKnight.money=117;core.material.enemys.darkKnight.experience=100;core.material.enemys.ghostSkeleton.hp=3333;core.material.enemys.ghostSkeleton.atk=1200;core.material.enemys.ghostSkeleton.def=1133;core.material.enemys.ghostSkeleton.money=112;core.material.enemys.ghostSkeleton.experience=100;core.material.enemys.blackMagician.hp=2000;core.material.enemys.blackMagician.atk=1106;core.material.enemys.blackMagician.def=973;core.material.enemys.blackMagician.money=106;core.material.enemys.blackMagician.experience=93;core.material.enemys.redKing.hp=20000;core.material.enemys.redKing.atk=1333;core.material.enemys.redKing.def=1333;core.material.enemys.redKing.money=133;core.material.enemys.redKing.experience=133}if(!core.getBlock(6,7,"MT19")){core.material.enemys.vampire.hp=45000;core.material.enemys.vampire.atk=2550;core.material.enemys.vampire.def=2250;core.material.enemys.vampire.money=312;core.material.enemys.vampire.experience=275}if(!core.getBlock(6,2,"MT21")){core.material.enemys.redKing.hp=30000;core.material.enemys.redKing.atk=2666;core.material.enemys.redKing.def=2666;core.material.enemys.redKing.money=166;core.material.enemys.redKing.experience=166;core.material.enemys.darkKnight.hp=2400;core.material.enemys.darkKnight.atk=2612;core.material.enemys.darkKnight.def=2400;core.material.enemys.darkKnight.money=146;core.material.enemys.darkKnight.experience=125;core.material.enemys.ghostSkeleton.hp=4999;core.material.enemys.ghostSkeleton.atk=2400;core.material.enemys.ghostSkeleton.def=2266;core.material.enemys.ghostSkeleton.money=140;core.material.enemys.ghostSkeleton.experience=125;core.material.enemys.blackMagician.hp=3000;core.material.enemys.blackMagician.atk=2212;core.material.enemys.blackMagician.def=1946;core.material.enemys.blackMagician.money=132;core.material.enemys.blackMagician.experience=116;core.material.enemys.vampire.hp=60000;core.material.enemys.vampire.atk=3400;core.material.enemys.vampire.def=3000;core.material.enemys.vampire.money=390;core.material.enemys.vampire.experience=343}}},actions:{onKeyUp:function(d,a){if(core.isMoving()){return}if(a&&d>=48&&d<=57){core.items.quickLoadEquip(d-48);return}switch(d){case 27:core.openSettings(true);break;case 88:case 76:core.openBook(true);break;case 71:case 74:core.useFly(true);break;case 65:core.doSL("autoSave","load");break;case 83:core.save(true);break;case 68:core.load(true);break;case 69:core.ui.drawCursor();break;case 84:core.openToolbox(true);break;case 81:core.openEquipbox(true);break;case 90:core.turnHero();break;case 75:case 86:core.openQuickShop(true);break;case 32:core.getNextItem();break;case 82:core.actions._clickSyncSave_replay();break;case 33:case 34:core.ui.drawMaps();break;case 77:core.ui.drawPaint();break;case 66:core.ui.drawStatistics();break;case 72:core.ui.drawHelp();break;case 78:core.restart();break;case 79:core.actions._clickGameInfo_openProject();break;case 80:core.actions._clickGameInfo_openComments();break;case 49:if(core.hasItem("pickaxe")){if(core.canUseItem("pickaxe")){core.status.route.push("key:49");core.useItem("pickaxe",true)}else{core.drawTip("当前不能使用破墙镐")}}break;case 50:if(core.hasItem("bomb")){if(core.canUseItem("bomb")){core.status.route.push("key:50");core.useItem("bomb",true)}else{core.drawTip("当前不能使用炸弹")}}else{if(core.hasItem("hammer")){if(core.canUseItem("hammer")){core.status.route.push("key:50");core.useItem("hammer",true)}else{core.drawTip("当前不能使用圣锤")}}}break;case 51:if(core.hasItem("centerFly")){core.ui.drawCenterFly()}break;case 52:var e=["icePickaxe","snow","earthquake","upFly","downFly","jumpShoes","lifeWand","poisonWine","weakWine","curseWine","superWine"];for(var b=0;b<e.length;b++){var c=e[b];if(core.canUseItem(c)){core.status.route.push("key:52");core.useItem(c,true);break}}break;case 55:core.getNextItem();break;case 118:core.debug();break;case 87:if(core.hasItem("skill1")){core.status.route.push("key:87");core.useItem("skill1",true)}break}}},control:{saveData:function(){var d={};for(var b in core.values){if(!core.same(core.values[b],core.data.values[b])){d[b]=core.clone(core.values[b])}}var a={floorId:core.status.floorId,hero:core.clone(core.status.hero),hard:core.status.hard,maps:core.maps.saveMap(),route:core.encodeRoute(core.status.route),values:d,shops:{},version:core.firstData.version,time:new Date().getTime()};if(core.flags.checkConsole){a.hashCode=core.utils.hashCode(a.hero)}for(var c in core.status.shops){a.shops[c]={times:core.status.shops[c].times||0,visited:core.status.shops[c].visited||false}}return a},loadData:function(b,a){core.resetGame(b.hero,b.hard,b.floorId,core.maps.loadMap(b.maps),b.values);core.status.route=core.decodeRoute(b.route);for(var d in core.status.shops){if(b.shops[d]){core.status.shops[d].times=b.shops[d].times;core.status.shops[d].visited=b.shops[d].visited}}core.status.textAttribute=core.getFlag("textAttribute",core.status.textAttribute);var e=core.getFlag("globalAttribute",core.status.globalAttribute);if(!core.same(e,core.status.globalAttribute)){core.status.globalAttribute=e;core.updateGlobalAttribute()}core.events.setVolume(core.getFlag("__volume__",1),0);var c=core.getFlag("heroIcon","hero.png");c=core.getMappedName(c);if(core.material.images.images[c]){core.material.images.hero=core.material.images.images[c];core.material.icons.hero.width=core.material.images.images[c].width/4;core.material.icons.hero.height=core.material.images.images[c].height/4}core.updateEnemys();core.changeFloor(b.floorId,null,b.hero.loc,0,function(){if(core.hasFlag("__bgm__")){core.playBgm(core.getFlag("__bgm__"))}if(a){a()}},true)},updateStatusBar:function(){core.events.checkLvUp();if(core.flags.enableHPMax){core.setStatus("hp",Math.min(core.getStatus("hpmax"),core.getStatus("hp")))}if(core.status.floorId){core.setStatusBarInnerHTML("floor",core.status.maps[core.status.floorId].name)}core.setStatusBarInnerHTML("name",core.getStatus("name"));core.setStatusBarInnerHTML("lv",core.getLvName()+"级");var c=["hpmax","hp","mana","atk","def","mdef","money","experience"];c.forEach(function(d){core.status.hero[d]=Math.floor(core.status.hero[d]);core.setStatusBarInnerHTML(d,core.getRealStatus(d))});if(core.flags.enableMana){if(core.status.hero.manamax!=null&&core.status.hero.manamax>=0){core.status.hero.mana=Math.min(core.status.hero.mana,core.status.hero.manamax);core.setStatusBarInnerHTML("mana",core.status.hero.mana+"/"+core.status.hero.manamax)}else{core.setStatusBarInnerHTML("mana",core.status.hero.mana)}}if(core.flags.enableSkill){core.setStatusBarInnerHTML("skill",core.getFlag("skillName","无"))}if(core.flags.enableLevelUp&&core.status.hero.lv<core.firstData.levelUp.length){var b=core.calValue(core.firstData.levelUp[core.status.hero.lv].need);if(core.flags.levelUpLeftMode){core.setStatusBarInnerHTML("up",core.formatBigNumber(b-core.getStatus("experience"))||"")}else{core.setStatusBarInnerHTML("up",core.formatBigNumber(b)||"")}}else{core.setStatusBarInnerHTML("up","")}var a=["yellowKey","blueKey","redKey"];a.forEach(function(d){core.setStatusBarInnerHTML(d,core.setTwoDigits(core.itemCount(d)))});if(core.flags.enableDebuff){core.setStatusBarInnerHTML("poison",core.hasFlag("poison")?"毒":"");core.setStatusBarInnerHTML("weak",core.hasFlag("weak")?"衰":"");core.setStatusBarInnerHTML("curse",core.hasFlag("curse")?"咒":"")}if(core.flags.enablePZF){core.setStatusBarInnerHTML("pickaxe","破"+core.itemCount("pickaxe"));core.setStatusBarInnerHTML("bomb","炸"+core.itemCount("bomb"));core.setStatusBarInnerHTML("fly","飞"+core.itemCount("centerFly"))}core.statusBar.hard.innerHTML=core.status.hard;core.drawStatusBar();core.updateCheckBlock();core.updateDamage()},updateCheckBlock:function(m){m=m||core.status.floorId;if(!m||!core.status.maps){return}var F=core.floors[m].width,n=core.floors[m].height;var c=core.getMapBlocksObj(m);var f={},D={},B={},a={};for(var r in c){var b=c[r],G=b.x,H=b.y,o=b.event.id,j=core.material.enemys[o];if(o=="lavaNet"&&b.event.trigger=="passNet"&&!core.hasItem("shoes")){f[r]=(f[r]||0)+core.values.lavaDamage;D[r]="血网伤害"}if(j&&core.hasSpecial(j.special,15)&&!core.hasFlag("no_zone")){var u=j.range||1;var I=false;if(j.zoneSquare!=null){I=j.zoneSquare}for(var h=-u;h<=u;h++){for(var i=-u;i<=u;i++){if(h==0&&i==0){continue}var s=G+h,t=H+i,e=s+","+t;if(s<0||s>=F||t<0||t>=n){continue}if(!I&&Math.abs(h)+Math.abs(i)>u){continue}f[e]=(f[e]||0)+(j.value||0);D[e]="领域伤害"}}}if(j&&core.hasSpecial(j.special,18)&&!core.hasFlag("no_snipe")){for(var g in core.utils.scan){var s=G+core.utils.scan[g].x,t=H+core.utils.scan[g].y,e=s+","+t;if(s<0||s>=F||t<0||t>=n){continue}f[e]=(f[e]||0)+(j.value||0);D[e]="阻击伤害";var v=core.reverseDirection(g);var z=G+core.utils.scan[v].x,A=H+core.utils.scan[v].y;if(z>=0&&z<F&&A>=0&&A<n&&core.getBlock(z,A,m)==null){B[e]=(B[e]||[]).concat([[G,H,o,v]])}}}if(j&&core.hasSpecial(j.special,24)&&!core.hasFlag("no_laser")){for(var s=0;s<F;s++){var e=s+","+H;if(s!=G){f[e]=(f[e]||0)+(j.value||0);D[e]="激光伤害"}}for(var t=0;t<n;t++){var e=G+","+t;if(t!=H){f[e]=(f[e]||0)+(j.value||0);D[e]="激光伤害"}}}if(j&&core.enemys.hasSpecial(j.special,27)){for(var g in core.utils.scan){var s=G+core.utils.scan[g].x,t=H+core.utils.scan[g].y,e=s+","+t;if(s<0||s>=F||t<0||t>=n){continue}a[e]=(a[e]||[]).concat([[G,H,o,g]])}}}if(!core.hasFlag("no_betweenAttack")){for(var G=0;G<F;G++){for(var H=0;H<n;H++){var r=G+","+H;var l=null;var p=c[(G-1)+","+H],w=c[(G+1)+","+H];if(p&&w&&p.id==w.id){if(core.hasSpecial(p.event.id,16)){l=p.event.id}}var C=c[G+","+(H-1)],d=c[G+","+(H+1)];if(C&&d&&C.id==d.id){if(core.hasSpecial(C.event.id,16)){l=C.event.id}}if(l!=null){var q=core.status.hero.hp-(f[r]||0);if(q>1){var E=Math.floor((q+(core.flags.betweenAttackCeil?1:0))/2);if(core.flags.betweenAttackMax){var k=core.getDamage(l,G,H,m);if(k!=null&&k<E){E=k}}if(E>0){f[r]=(f[r]||0)+E;D[r]="夹击伤害"}}}}}}core.status.checkBlock={damage:f,type:D,snipe:B,ambush:a,cache:{}}},moveOneStep:function(a,b){core.playSound("step.mp3");core.setHeroLoc("x",a,true);core.setHeroLoc("y",b,true);core.status.hero.steps++;core.updateFollowers();core.drawHero();if(core.hasFlag("poison")){core.status.hero.statistics.poisonDamage+=core.values.poisonDamage;core.status.hero.hp-=core.values.poisonDamage;if(core.status.hero.hp<=0){core.status.hero.hp=0;core.updateStatusBar();core.events.lose();return}}core.updateStatusBar()},moveDirectly:function(c,d,a){if(a==null){a=core.canMoveDirectly(c,d)}if(a>=0){core.playSound("step.mp3");core.clearMap("hero");var b=core.status.route[core.status.route.length-1];if(["left","right","up","down"].indexOf(b)>=0){core.setHeroLoc("direction",b)}core.setHeroLoc("x",c);core.setHeroLoc("y",d);core.drawHero();core.status.route.push("move:"+c+":"+d);core.status.hero.statistics.moveDirectly++;core.status.hero.statistics.ignoreSteps+=a;return true}return false},parallelDo:function(timestamp){if(!core.isPlaying()){return}if(core.status.floorId){try{eval(core.floors[core.status.floorId].parallelDo)}catch(e){main.log(e)}}}},ui:{drawStatusBar:function(){if(!core.flags.statusCanvas){return}var a=core.dom.statusCanvas,b=core.dom.statusCanvasCtx;b.clearRect(0,0,a.width,a.height);if(!core.domStyle.showStatusBar){return}b.fillStyle=core.status.globalAttribute.statusBarColor||core.initStatus.globalAttribute.statusBarColor;b.font="italic bold 18px Verdana";var d=6,i=9,e=39;if(core.domStyle.isVertical){d=6;i=6;e=32}var h=["floor","hp","atk","def","mdef","money"];for(var c=0;c<h.length;c++){var f=h[c];b.drawImage(core.statusBar.icons[f],d,i,25,25);var g=(core.statusBar[f]||{}).innerText||" ";if(!/^[-a-zA-Z0-9`~!@#$%^&*()_=+\[{\]}\\|;:'",<.>\/?]*$/.test(g)){b.font="bold 18px Verdana"}b.fillText(g,d+36,i+20);b.font="italic bold 18px Verdana";if(core.domStyle.isVertical){if(c%3!=2){d+=131}else{d=6;i+=e}}else{i+=e}}b.fillStyle="#FFCCAA";b.fillText(core.statusBar.yellowKey.innerText,d+5,i+20);b.fillStyle="#AAAADD";b.fillText(core.statusBar.blueKey.innerText,d+40,i+20);b.fillStyle="#FF8888";b.fillText(core.statusBar.redKey.innerText,d+75,i+20)},drawStatistics:function(){return["yellowDoor","blueDoor","redDoor","greenDoor","steelDoor","yellowKey","blueKey","redKey","greenKey","steelKey","redJewel","blueJewel","greenJewel","yellowJewel","redPotion","bluePotion","greenPotion","yellowPotion","superPotion","pickaxe","bomb","centerFly","icePickaxe","snow","earthquake","upFly","downFly","jumpShoes","lifeWand","poisonWine","weakWine","curseWine","superWine","sword1","sword2","sword3","sword4","sword5","shield1","shield2","shield3","shield4","shield5",]},drawAbout:function(){core.ui.closePanel();core.lockControl();core.status.event.id="about";var c=48,f=36,d=core.__PIXELS__-2*c,a=core.__PIXELS__-2*f;core.setAlpha("ui",0.85);core.fillRect("ui",c,f,d,a,"#000000");core.setAlpha("ui",1);core.strokeRect("ui",c-1,f-1,d+1,a+1,"#FFFFFF",2);var e=c+24;core.setTextAlign("ui","left");var b=(core.status.globalAttribute||core.initStatus.globalAttribute).font;core.fillText("ui","HTML5 魔塔样板",e,f+35,"#FFD700","bold 22px "+b);core.fillText("ui","版本： "+main.__VERSION__,e,f+80,"#FFFFFF","bold 17px "+b);core.fillText("ui","作者： 艾之葵",e,f+112);core.fillText("ui","HTML5魔塔交流群：539113091",e,f+112+32)}}};var events_c12a15a8_c380_4b28_8144_256cba95f760={commonEvent:{"加点事件":[],"毒衰咒处理":[],"滑冰事件":[],"回收钥匙商店":[{type:"while",condition:"core.canUseQuickShop('keyShop2')==null",data:[{type:"choices",text:"\t[ ,woman]哦，欢迎你的到来，如果你手里缺少金币，我可以帮你：",choices:[{text:"卖出一把黄钥匙（$7）",action:[{type:"if",condition:"item:yellowKey","true":[{type:"addValue",name:"status:money",value:"7"},{type:"addValue",name:"item:yellowKey",value:"-1"},{type:"playSound",name:"keySold.mp3"},{type:"continue"}]}]},{text:"卖出一把蓝钥匙（$35）",action:[{type:"if",condition:"item:blueKey","true":[{type:"addValue",name:"status:money",value:"35"},{type:"addValue",name:"item:blueKey",value:"-1"},{type:"playSound",name:"keySold.mp3"},{type:"continue"}]}]},{text:"卖出一把红钥匙（$70）",action:[{type:"if",condition:"item:redKey","true":[{type:"addValue",name:"status:money",value:"70"},{type:"addValue",name:"item:redKey",value:"-1"},{type:"playSound",name:"keySold.mp3"},{type:"continue"}]}]},{text:"离开商店",action:[{type:"playSound",name:"door.mp3"},{type:"exit"}]}]},{type:"playSound",name:"keyUnsold.mp3"}]},"\t[woman]十四楼起必须携带风之罗盘才能访问全局商店"]}};var plugins_bb40132b_638b_4a9f_b028_d3fe47acc8d1={init:function(){this._afterLoadResources=function(){}},drawLight:function(){this.drawLight=function(e,a,d,c){var b=core.getContextByName(e);if(b==null){if(typeof e=="string"){b=core.createCanvas(e,0,0,core.__PIXELS__,core.__PIXELS__,98)}else{return}}b.mozImageSmoothingEnabled=false;b.webkitImageSmoothingEnabled=false;b.msImageSmoothingEnabled=false;b.imageSmoothingEnabled=false;core.clearMap(e);if(a==null){a=0.9}b.fillStyle="rgba(0,0,0,"+a+")";b.fillRect(0,0,b.canvas.width,b.canvas.height);c=core.clamp(c,0,1);b.globalCompositeOperation="destination-out";d.forEach(function(h){var j=h[0],k=h[1],i=h[2];var f=parseInt(i*c);var g=b.createRadialGradient(j,k,f,j,k,i);g.addColorStop(0,"rgba(0,0,0,1)");g.addColorStop(1,"rgba(0,0,0,0)");b.beginPath();b.fillStyle=g;b.arc(j,k,i,0,2*Math.PI);b.fill()});b.globalCompositeOperation="source-over"}}};